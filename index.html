<!DOCTYPE html>
<html>
  <head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Data</title>
  <link rel="stylesheet" href="sch.css" type="text/css" media="all" />
  <script src="sch.js">sch.js</script>
  </style>
    
  </style>
  <style>
  h3{
  position :absolute;
  top:-20px;
  color: red;
  background: linear-gradient(45deg, #41ff64,#428ff4);
  width: 400px;
  height: 35px;
  filter :blur(1px);
  
  }
  </style>
  </head>
  <body>
 <h3>School Data</h3>
      </div>
  <div class="menu-icon" onclick="toggleMenu()">
    <div></div>
    <div></div>
    <div></div>
   
  </div>
 
  
  <div class="nav" id="navMenu">
    
    <a onclick="rightheader()">Update Completion</a>
    <a onclick="window.location.href='Data Entrynotebook.html'">Update Notebook</a>
    <a onclick="window.location.href='Hwinput.html'">Update HomeWork </a>
    <a onclick="window.location.href='Tetsinput.html'">Update Test</a>
    <a onclick="window.location.href='InCopycheck.html'">Update Copy check</a>
    
    
  </div>
  
  <script>
    function toggleMenu() {
      const nav = document.getElementById("navMenu");
      nav.style.display = nav.style.display === "block" ? "none" : "block";
    }
  </script>
  <div class="header" >
  
  <div id="workdone"></div>
 <b> <div id="date"></div></b> 

    <div id="target" onclick="">
  <ul id="unchecked-list" style="text-align:left;"></ul>
    <div id="done-percent" style="font-weight:bold;background:#fff;border-radius:10px"></div>

  </div>

  <script>
    // load
    let homework = JSON.parse(localStorage.getItem("homework") || "[]");

    // --- TEST SEED: remove this block in production ---
    if (!homework.length) {
      const today = new Date().toISOString().slice(0,10);
      const yesterday = new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString().slice(0,10);
      const twoDaysAgo = new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString().slice(0,10);

      homework = [
        { subject: "Math", notes: "Ex 5.2", date: today, done: false },         // today â€” should NOT be disabled
        { subject: "Science", notes: "Read ch.2", date: yesterday, done: false }, // yesterday â€” likely disabled (depends on current time)
        { subject: "History", notes: "Map work", date: twoDaysAgo, done: false }  // older â€” will be disabled
      ];
      localStorage.setItem("homework", JSON.stringify(homework));
    }
    // --- end seed ---

    function formatDate(dateStr) {
      const d = new Date(dateStr);
      const dd = String(d.getDate()).padStart(2,'0');
      const mm = String(d.getMonth() + 1).padStart(2,'0');
      const yy = String(d.getFullYear()).slice(-2);
      const today = new Date().toISOString().slice(0,10);
      const yesterday = new Date(Date.now() - 86400000).toISOString().slice(0,10);

      if (dateStr === today) return "Today";
      if (dateStr === yesterday) return "Yesterday";
      return `${dd}/${mm}/${yy}`;
    }

    function render() {
      const list = document.getElementById("list");
      list.innerHTML = "";

      // group by date
      const groups = {};
      homework.forEach((item, index) => {
        const key = item.date;
        if (!groups[key]) groups[key] = [];
        groups[key].push({ ...item, index });
      });

      // start of today in local timezone
      const startOfToday = new Date();
      startOfToday.setHours(0,0,0,0);

      // LIMIT: change this to any number of hours you want
      const hoursLimit = 10;
      const hoursLimitMs = hoursLimit * 60 * 60 * 1000; // 10 * 3600 * 1000

      // sort dates descending
      Object.keys(groups).sort((a,b) => b.localeCompare(a)).forEach(dateKey => {
        const group = document.createElement("div");
        group.className = "group";
        group.innerHTML = `<h3>${formatDate(dateKey)}</h3>`;

        groups[dateKey].forEach(({ subject, notes, done, index }) => {
          const div = document.createElement("div");
          div.className = "subject";

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = !!done;

          // Determine due start:
          // If you store a full datetime (item.datetime), use that.
          // Otherwise we assume the due moment is that date at 00:00 local time.
          const item = homework[index];
          let dueStart;
          if (item.datetime) {
            dueStart = new Date(item.datetime); // user-supplied full datetime
          } else {
            dueStart = new Date(dateKey + "T00:00:00"); // local midnight for that date
          }

          const now = new Date();

          // disable only if the dueStart is strictly before today (i.e., a past date)
          // AND at least `hoursLimit` hours have passed since dueStart
          const isBeforeToday = dueStart < startOfToday;
          const passedLimit = (now - dueStart) >= hoursLimitMs;
          checkbox.disabled = !!(isBeforeToday && passedLimit);

          checkbox.onchange = () => {
            if (!checkbox.disabled) toggleDone(index);
          };

          const label = document.createElement("label");
          label.className = done ? "done" : "";
          if (checkbox.disabled) {
            label.classList.add("disabled");
            label.title = `Disabled: more than ${hoursLimit} hours past due`;
          }
          label.textContent = `${subject}${notes ? ': ' + notes : ''}`;

          div.appendChild(checkbox);
          div.appendChild(label);
          group.appendChild(div);
        });

        list.appendChild(group);
      });
    }

    function toggleDone(index) {
      homework[index].done = !homework[index].done;
      localStorage.setItem("homework", JSON.stringify(homework));
      render();
    }

    render();
  </script>
  <!-- note book complete work -->
  <div id="ncw" onclick="">
     <!--english work complete-->
<div id="enwc">}|[\[\{\{</div>
<!--hindi work complete-->
<div id="hiwc">}|[|[|}{|</div>
<!--sst work complete-->
<div id="mtywc">]\{\{|[}<] </div>
<!--mathsY work complete-->
<div id="scwc">]\{~}|]<}</div>
<!--science work complete-->
<div id="sstwc">{|[\{|}\[</div> 
<!-- mathsB work complete-->
<div id="mtbwc">[<[\{\[|}<</div>
    <!--ncwp -notebook complete work percentage-->
    <b> <div id="ncwp">[]}[[]</div></b>
  </div>
  </div>
  <div class="container">
    <!--hindi work -->
  <div id="hw" onclick="hwshow()">ðŸ“ƒ</div>
  <!-- note book data -->
  <div id="nd" onclick="nbshow()">ðŸ“š</div>
  <!-- test available -->
  <div id="tst" onclick="window.location.href='Testview.html'">ðŸ—ž</div>
  <!-- copy check infuture -->  <div id="cc" onclick="window.location.href='DashboardCopy.html'">ðŸ“–</div>
<script>
  function Time(){
  const now = new Date();
console.log(now.toLocaleString());
  let hour = now.getHours();
  let minute = now.getMinutes();
  let second =   now.getSeconds();
  
  let seconds = second < 10 ? '0'+second:second;
  let hours = hour < 10 ? '0'+hour:hour;
  let hoursf = hours > 12 ? hours - 12:hours;
  let minutes = minute < 10 ? '0'+minute:minute;
  let ampm = hour > 12 ? 'PM':'AM'
document.getElementById('date').innerHTML = 'last update:'+ hoursf+':'+minutes+':'+seconds+' '+ampm;
  
  
  }
  setInterval(Time,10);
  
function ncw(){
var enwc = document.getElementById('enwc');
var hiwc = document.getElementById('hiwc');
var mtywc = document.getElementById('mtywc');
var scwc = document.getElementById('scwc');
var sstwc = document.getElementById('sstwc');
var mtbwc = document.getElementById('mtbwc');
var ncwp = document.getElementById('ncwp');
var sstw = localStorage.getItem('%sst');
var mtbw = localStorage.getItem("%mtb");
var enw = localStorage.getItem("%en");
var mtyw = localStorage.getItem("%mty");
var scw = localStorage.getItem("%sc");
var hiw = localStorage.getItem("%hi");
var com_per = localStorage.getItem("com_per");
let sstf = parseFloat(sstw);
let hif = parseFloat(hiw);
let scf = parseFloat(scw);
let enf = parseFloat(enw);
let mtyf = parseFloat(mtyw);
let mtbf = parseFloat(mtbw);


hiwc.innerHTML =  'Hindi'+' '+hiw+'%';
enwc.innerHTML = 'English'+' '+enw+'%';
sstwc.innerHTML = 'Sst'+' '+sstw+'%';
mtywc.innerHTML = 'MathsY'+' '+mtyw+'%';
scwc.innerHTML = 'Science'+' '+scw+'%';
mtbwc.innerHTML = 'MathsB'+' '+mtbw+'%';

let sumf = (sstf+scf+hif+enf+mtbf+mtyf)/6
let sum = sumf.toFixed(1);


ncwp.innerHTML = sum+'%'+' '+'Done'
  }
setInterval(ncw,1000);

function rightheader(){
  window.location.href="Notebook.html"
  
}
function hwshow(){
  window.location.href="Homework.html"
}
function nbshow() {
  window.location.href = "notebookDataset.html"
  }
    
  </script>


  </body>
</html>
